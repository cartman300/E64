SHDLR 0b, &__PRINT
NONPRIV

CALL_64 &MAIN
_HALT:
	HALT
	JMP_64 &_HALT

; GP0 - string location
__PRINT:
	PUSH_R GP1
	PUSH_R GP2
	PUSH_R GP3

	READ32_R_R		GP1, GP0
	ADD_R_64		GP0, 4l
	MOV_R_64		GP2, 0l

	_PRINT_LOOP:
		CMP_R_R		GP2, GP1
		JGE_64		&_PRINT_END

		MOV_R_R		GP3, GP2
		ADD_R_R		GP3, GP0
		READ8_R_R	GP3, GP3
		OUT_64_R	0l, GP3

		ADD_R_64	GP2, 1l
		JMP_64		&_PRINT_LOOP

	_PRINT_END:
		POP_R GP3
		POP_R GP2
		POP_R GP1
		RET

PRINT:
	INT_8 0b
	RET